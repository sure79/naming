<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>이름 궁합 분석기</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
      line-height: 1.6;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    }
    h1 {
      color: #2c3e50;
      text-align: center;
      margin-bottom: 30px;
      font-size: 2em;
    }
    h2 {
      color: #34495e;
      margin-top: 30px;
    }
    .input-group {
      margin: 20px 0;
    }
    input {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 2px solid #ddd;
      border-radius: 8px;
      box-sizing: border-box;
      transition: border-color 0.3s;
    }
    input:focus {
      border-color: #3498db;
      outline: none;
    }
    button {
      width: 100%;
      padding: 15px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 10px;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #2980b9;
    }
    .result {
      margin-top: 30px;
      padding: 20px;
      background: #f9f9f9;
      border-radius: 10px;
      display: none;
    }
    .number {
      font-weight: bold;
      color: #3498db;
    }
    .recommended-names {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-top: 20px;
    }
    .name-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }
    .name-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    .name-card .name {
      font-size: 24px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 10px;
    }
    .name-card .compatibility-score {
      font-size: 18px;
      color: #3498db;
      margin: 8px 0;
    }
    .name-card .number-info {
      color: #7f8c8d;
      font-size: 14px;
    }
    .error {
      color: #e74c3c;
      text-align: center;
      margin-top: 10px;
      padding: 10px;
      background: #fde2e2;
      border-radius: 5px;
      display: none;
    }
    @media (max-width: 600px) {
      .recommended-names {
        grid-template-columns: 1fr;
      }
      .container {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <h1>이름 궁합 분석기</h1>

  <div class="input-group">
    <input type="text" id="nameInput" placeholder="예) 김민서" maxlength="5"/>
    <button onclick="analyzeName()">분석하기</button>
  </div>

  <div id="error" class="error"></div>

  <div id="result" class="result">
    <h2>분석 결과</h2>
    <div id="analysis"></div>
    <h2>궁합이 좋은 글자 TOP 30</h2>
    <div id="recommendedNames" class="recommended-names"></div>
  </div>
</div>

<script>
  // ----------------------------
  // [사주번호] nameToNumber
  //  (성 + 자주 쓰는 이름 음절)
  // ----------------------------
  const nameToNumber = {
    // 흔히 쓰이는 성(20개)
    '김': 3, '이': 9, '박': 8, '최': 7, '정': 6, '강': 8, '조': 9, '윤': 10, '장': 9, '임': 3,
    '한': 10, '오': 8, '서': 9, '신': 11, '권': 8, '황': 8, '안': 10, '송': 8, '전': 10, '홍': 9,

    // 자주 쓰이는 이름 음절(예시)
    '은': 2,
    
    // 3번 (여화제)
    '민': 3, '임': 3, '노': 3, '모': 3, '삼': 3, '묵': 3, 
    '문': 3, '미': 3, '누': 3, '흠': 3, '움': 3, '점': 3,
    '무': 3, '겸': 3, '림': 3, '매': 3, '맹': 3, 
    '나': 3, '남': 3, '마': 3, '명': 3, '목': 3,
    '김': 3, '금': 3, '막': 3, '봄': 3, '내': 3,
    
    // 4번 (황제)
    '석': 4, '로': 4, '학': 4, '슬': 4, 
    '라': 4, '종': 4, '루': 4, '일': 4,
    '식': 4, '래': 4, '례': 4, '록': 4,
    '소': 4, '리': 4, '말': 4, '란': 4,
    '숙': 4, '근': 4, '솔': 4, '순': 4,
    
    // 5번 (교황)
    '태': 5, '택': 5, '규': 5, '분': 5, '돔': 5, '던': 5, '만': 5, '엽': 5, '평': 5, '효': 5,
    '훈': 5, '도': 5, '봄': 5, '다': 5, '둔': 5, '령': 5, '봉': 5, '탁': 5, '탄': 5,
    '대': 5, '덕': 5, '보': 5, '단': 5, '득': 5, '련': 5, '운': 5, '편': 5, '섭': 5,
    '복': 5, '필': 5, '담': 5, '듬': 5, '렴': 5, '엄': 5, '표': 5, '포': 5,
    '돈': 5, '두': 5, '갑': 5, '당': 5, '딘': 5, '후': 5, '욱': 5, '팽': 5,
    
    // 6번 (연인)
    '정': 6,
    
    // 7번 (전차)
    '최': 7, '동': 7, '차': 7, '추': 7, '건': 7,
    '채': 7, '화': 7, '좌': 7, '찬': 7, '하': 7, '준': 7,
    
    // 8번 (힘)
    '박': 8, '가': 8, '람': 8, '혜': 8, '늘': 8, '호': 8, '해': 8, '예': 8, '중': 8, 
    '강': 8, '율': 8, '용': 8, '송': 8, '응': 8, '사': 8, '병': 8, '열': 8, '비': 8,
    '양': 8, '백': 8, '승': 8, '옥': 8, '을': 8, '상': 8, '오': 8, '흥': 8, '거': 8,
    '권': 8, '형': 8, '영': 8, '범': 8, '고': 8, '배': 8, '랑': 8, '빛': 8, '결': 8,'황': 8,

    // 9번 (은둔자)
    '순': 9, '정': 9, '이': 9, '서': 9, '선': 9, '여': 9, '녀': 9, '존': 9, '회': 9,
    '지': 9, '향': 9, '장': 9, '제': 9, '주': 9, '철': 9, '님': 9, '심': 9,
    '수': 9, '조': 9, '재': 9, '성': 9, '자': 9, '기': 9, '실': 9, '찰': 9, '어': 9,
    '희': 9, '홍': 9, '유': 9, '우': 9, '언': 9, '귀': 9, '춘': 9, '설': 9,
    '길': 9, '행': 9, '휴': 9, '헌': 9, '잠': 9, '허': 9, '갈': 9,
    
    // 10번 (운명의 수레바퀴)
    '안': 10, '연': 10, '환': 10, '윤': 10, '인': 10, '란': 10,
    '원': 10, '빈': 10, '론': 10, '완': 10, '전': 10, '온': 10,
    '린': 10, '한': 10, '손': 10,
    
    // 11번 (정의)
    '현': 11, '진': 11, '경': 11, '극': 11, '신': 11, '청': 11, '피': 11, '염': 11,
    '키': 11, '창': 11, '간': 11, '닷': 11, '심': 11, '척': 11, '타': 11, '음': 11,
    '천': 11, '세': 11, '감': 11, '본': 11, '션': 11, '첨': 11, '탐': 11, '품': 11,
    '위': 11, '균': 11, '견': 11, '벼': 11, '숀': 11, '초': 11, '파': 11, '총': 11,
    '의': 11, '검': 11, '곤': 11, '변': 11, '직': 11, '카': 11, '판': 11, '휘': 11
  };

  // ----------------------------
  // 숫자 궁합 테이블
  // ----------------------------
  const numberCompatibility = {
    2:  [4, 8, 11],
    3:  [6, 9],
    4:  [2, 7, 10],
    5:  [3, 8, 11],
    6:  [3, 9],
    7:  [4, 10],
    8:  [2, 5, 11],
    9:  [3, 6],
    10: [4, 7],
    11: [2, 5, 8]
  };

  // ----------------------------
  // 숫자별 타로 의미 (간단)
  // ----------------------------
  const tarotMeanings = {
    2:  "여사제 - 차분하고 직관적인 성향",
    3:  "여황제 - 풍요롭고 창조적인 성향",
    4:  "황제 - 리더십과 권위가 있는 성향",
    5:  "교황 - 전통과 가르침을 중시하는 성향",
    6:  "연인 - 조화롭고 사랑을 추구하는 성향",
    7:  "전차 - 도전적이고 진취적인 성향",
    8:  "힘 - 강인한 인내심과 용기를 갖춘 성향",
    9:  "은둔자 - 지혜롭고 깊은 내면 성찰을 지닌 성향",
    10: "운명의 수레바퀴 - 변화에 유연하고 운을 잘 타는 성향",
    11: "정의 - 공정하고 논리적인 성향"
  };

  // ----------------------------
  // 메인 분석 함수
  // ----------------------------
  function analyzeName() {
    const input = document.getElementById('nameInput').value.trim();
    const errorDiv = document.getElementById('error');
    const resultDiv = document.getElementById('result');
    const analysisDiv = document.getElementById('analysis');
    const recommendedNamesDiv = document.getElementById('recommendedNames');

    // 에러 초기화
    errorDiv.style.display = 'none';
    errorDiv.textContent = '';

    if (input.length === 0) {
      showError('이름을 입력해주세요.');
      return;
    }
    if (input.length < 2) {
      showError('성 + 이름 형태로 최소 2글자 이상 입력해주세요. (예: 김민)');
      return;
    }

    // 입력 -> 숫자 변환
    const originalNumbers = [];
    for (let char of input) {
      if (!nameToNumber[char]) {
        showError(`분석 불가한 글자(${char})입니다.`);
        return;
      }
      originalNumbers.push(nameToNumber[char]);
    }

    // 분석 결과 보이기
    resultDiv.style.display = 'block';

    // 타로 정보 표시
    const uniqueNums = [...new Set(originalNumbers)];
    const tarotText = uniqueNums.map(n => {
      const meaning = tarotMeanings[n] ? tarotMeanings[n] : '(정보 없음)';
      return `
        <div>
          <strong>숫자: ${n}</strong><br>
          <em>${meaning}</em>
        </div>
      `;
    }).join("<hr>");

    analysisDiv.innerHTML = `
      <p><strong>[${input}]</strong> 이름의 숫자들: <strong>${originalNumbers.join(', ')}</strong></p>
      ${tarotText}
    `;

    // 궁합 계산
    const recommendedList = recommendSingleChars(originalNumbers, 30);

    if (recommendedList.length === 0) {
      recommendedNamesDiv.innerHTML = "<p>추천할 만한 글자가 없습니다.</p>";
    } else {
      recommendedNamesDiv.innerHTML = recommendedList.map(item => `
        <div class="name-card">
          <div class="name">${item.char}</div>
          <div class="compatibility-score">점수: ${item.score}점</div>
          <div class="number-info">글자 숫자: ${item.charNum}</div>
        </div>
      `).join('');
    }

    // 에러 표시 함수
    function showError(msg) {
      errorDiv.style.display = 'block';
      errorDiv.textContent = msg;
      resultDiv.style.display = 'none';
    }
  }

  // ----------------------------
  // "한 글자" 추천 함수
  //  - 입력 이름의 숫자 vs 단일 글자의 숫자
  //  - 궁합 점수를 계산하여, 높은 순으로 최대 count개
  // ----------------------------
  function recommendSingleChars(originalNumbers, count = 20) {
    // (1) 중복된 문자(성,음절) 포함될 수 있으므로 전체 key 중, 성+이름 음절에 해당하는 것만 모음
    // 하지만 여기선 모든 key가 대상 가능
    const allChars = Object.keys(nameToNumber);

    // (2) 각 글자별로 궁합 점수 계산
    const scored = allChars.map(char => {
      const charNum = nameToNumber[char];
      const score = calculateCompatibilityScore(originalNumbers, charNum);
      return { char, charNum, score };
    });

    // (3) 점수가 70점 이상인 글자만 추출
    const filtered = scored.filter(item => item.score >= 70);

    // (4) 높은 점수 -> 낮은 점수 순으로 정렬
    filtered.sort((a, b) => b.score - a.score);

    // (5) 최대 count개만 반환
    return filtered.slice(0, count);
  }

  // ----------------------------
  // 궁합 점수 계산 (단일 글자 버전)
  // ----------------------------
  function calculateCompatibilityScore(originalNums, candidateNum) {
    let score = 70; // 기본 70점
    // originalNums의 각 숫자와 candidateNum을 비교
    for (let on of originalNums) {
      const compArray = numberCompatibility[on];
      if (compArray && compArray.includes(candidateNum)) {
        // 궁합에 포함되면 +15
        score += 15;
        // compArray 중 첫 번째 요소(가장 궁합이 좋은 요소)라면 +10
        if (candidateNum === compArray[0]) {
          score += 10;
        }
      }
    }
    return Math.min(score, 100);
  }
</script>
</body>
</html>
